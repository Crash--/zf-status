<script type="text/javascript">
    $(document).ready(function(){
        $('#accordion').accordion({
            active: false,
            collapsible: true,
            autoHeight: false
        });
        $('.tabs').tabs();
        $(".tooltip").tooltip({track: true});
    });
</script>
<div id="accordion">
<? if (!$this->outputCache->start('accordion')): ?>

    <? foreach ($this->zfService->getRecentActivity($this->repo) as $component => $details): ?>
        <h3>
            <a href="#"><?=$component;?>
                <span class="floatRight"><?=$details['latest']->format(false ?: 'M d, Y H:i O');?></span>
            </a> 
        </h3>
        <div>
            <div class="contrib-branches">
                <ul>
                    <? $i=0; foreach($details['commits'] as $hash => $commit): $i++ ?>
                        <li title="<?=htmlentities(nl2br($commit->getMessage()));?>" class="commit tooltip nostyle <? if(($i)%2): ?>even<? else: ?>odd<? endif; ?>">
                            <span class="date floatRight"><?= $commit->getAuthorTime()->format(false ?: 'M d, Y H:i O');?></span>
                            <img src="https://secure.gravatar.com/avatar/<?= $commit->getAuthorGravatar(); ?>?s=40&d=http://framework.zend.com/wiki/s/en/2148/48/_/images/icons/profilepics/anonymous.png" class="floatLeft" />
                            &nbsp;<strong>Author:</strong> <?= $commit->getAuthorName(); ?> &lt;<?=$commit->getAuthorEmail();?>&gt;
                            <? if ($commit->getAuthorEmail() != $commit->getCommitterEmail()): ?>
                                (Committed by <?= $commit->getCommitterName(); ?>)
                            <? endif; ?>
                            <br/> 
                            &nbsp;<strong>Commit:</strong> <a href="https://github.com/<?= $this->gh->emailToUsername($commit->getAuthorEmail(), $this->repo); ?>/zf2/commit/<?= $hash; ?>" target="_blank"><?= substr($hash, 0, 7); ?></a> 
                            <span style="padding: 5px 5px 0px 5px; display: block; clear: both;"><?= htmlentities($commit->getSubject()); ?></span></li>
                    <? endforeach; ?>                                 
                </ul>
            </div>
        </div>
    <? endforeach; ?>
    <? $this->outputCache->end(); ?>
<? endif; ?>
</div>
